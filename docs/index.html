---

title: transfertab

keywords: fastai
sidebar: home_sidebar

summary: "Allow transfer learning using structured data."
description: "Allow transfer learning using structured data."
nb_path: "nbs/index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install transfertab</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have two fastai learners <code>learn1</code> and <code>learn2</code>  created, with models having embedding layers for their categorical variables.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="p">,</span> <span class="n">learn2</span><span class="p">,</span> <span class="n">learn1</span><span class="o">.</span><span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;fastai.tabular.learner.TabularLearner at 0x7fa113e953a0&gt;,
 &lt;fastai.tabular.learner.TabularLearner at 0x7fa113e97160&gt;,
 TabularModel(
   (embeds): ModuleList(
     (0): Embedding(10, 6)
     (1): Embedding(17, 8)
     (2): Embedding(8, 5)
     (3): Embedding(16, 8)
     (4): Embedding(7, 5)
     (5): Embedding(6, 4)
     (6): Embedding(3, 3)
   )
   (emb_drop): Dropout(p=0.0, inplace=False)
   (bn_cont): BatchNorm1d(3, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
   (layers): Sequential(
     (0): LinBnDrop(
       (0): Linear(in_features=42, out_features=200, bias=False)
       (1): ReLU(inplace=True)
       (2): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
     )
     (1): LinBnDrop(
       (0): Linear(in_features=200, out_features=100, bias=False)
       (1): ReLU(inplace=True)
       (2): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
     )
     (2): LinBnDrop(
       (0): Linear(in_features=100, out_features=2, bias=True)
     )
   )
 ))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For transferring the embeddings from <code>learn1</code> to <code>learn2</code>, we first instantiate the <a href="/transfertab/transfer#TabTransfer"><code>TabTransfer</code></a> class with the learners and the categorical variables to transfer.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tabobj</span> <span class="o">=</span> <span class="n">TabTransfer</span><span class="p">(</span><span class="n">learn2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we can just call the transfer function to start the process.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tabobj</span><span class="o">.</span><span class="n">init_from_json</span><span class="p">(</span><span class="s2">&quot;../data/adults.json&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tabobj</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>mean is tensor([ 0.0027, -0.0050, -0.0009,  0.0026,  0.0011, -0.0004],
       grad_fn=&lt;MeanBackward1&gt;) for Parameter containing:
tensor([[-0.0156, -0.0057,  0.0052,  0.0033,  0.0026,  0.0061],
        [-0.0070, -0.0103, -0.0070,  0.0056,  0.0013,  0.0010],
        [ 0.0118, -0.0094, -0.0015, -0.0127, -0.0066, -0.0163],
        [ 0.0042, -0.0039, -0.0106, -0.0068, -0.0124, -0.0183],
        [-0.0010, -0.0093, -0.0049,  0.0077,  0.0119, -0.0080],
        [-0.0022, -0.0082,  0.0072,  0.0114,  0.0166,  0.0077],
        [-0.0007,  0.0102,  0.0074, -0.0060, -0.0025, -0.0020],
        [ 0.0077, -0.0047,  0.0007,  0.0156,  0.0053,  0.0077],
        [ 0.0181, -0.0021,  0.0005,  0.0061, -0.0098,  0.0119],
        [ 0.0113, -0.0067, -0.0055,  0.0019,  0.0041,  0.0066]],
       requires_grad=True)
0, &lt;class &#39;int&#39;&gt;
Transferring weights for class #na#, cat workclass from previous weights
old weight for class is tensor([ 0.0068, -0.0076,  0.0119,  0.0084,  0.0189,  0.0128],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0156, -0.0057,  0.0052,  0.0033,  0.0026,  0.0061],
       grad_fn=&lt;SliceBackward&gt;)
1, &lt;class &#39;int&#39;&gt;
Transferring weights for class  ?, cat workclass from previous weights
old weight for class is tensor([ 0.0055,  0.0081, -0.0086, -0.0007, -0.0017,  0.0016],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0070, -0.0103, -0.0070,  0.0056,  0.0013,  0.0010],
       grad_fn=&lt;SliceBackward&gt;)
2, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Federal-gov, cat workclass from previous weights
old weight for class is tensor([-0.0093, -0.0077, -0.0013,  0.0005, -0.0187, -0.0039],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0118, -0.0094, -0.0015, -0.0127, -0.0066, -0.0163],
       grad_fn=&lt;SliceBackward&gt;)
3, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Local-gov, cat workclass from previous weights
old weight for class is tensor([ 0.0048, -0.0019, -0.0013, -0.0093,  0.0103, -0.0037],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0042, -0.0039, -0.0106, -0.0068, -0.0124, -0.0183],
       grad_fn=&lt;SliceBackward&gt;)
4, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Never-worked, cat workclass from previous weights
old weight for class is tensor([-0.0015,  0.0175,  0.0141,  0.0016, -0.0165,  0.0019],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0010, -0.0093, -0.0049,  0.0077,  0.0119, -0.0080],
       grad_fn=&lt;SliceBackward&gt;)
5, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Private, cat workclass from previous weights
old weight for class is tensor([-0.0078, -0.0189,  0.0027, -0.0117, -0.0189,  0.0057],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0022, -0.0082,  0.0072,  0.0114,  0.0166,  0.0077],
       grad_fn=&lt;SliceBackward&gt;)
6, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Self-emp-inc, cat workclass from previous weights
old weight for class is tensor([ 0.0014, -0.0126,  0.0135,  0.0033,  0.0059,  0.0031],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0007,  0.0102,  0.0074, -0.0060, -0.0025, -0.0020],
       grad_fn=&lt;SliceBackward&gt;)
7, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Self-emp-not-inc, cat workclass from previous weights
old weight for class is tensor([-0.0043, -0.0021, -0.0005, -0.0076, -0.0050, -0.0083],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0077, -0.0047,  0.0007,  0.0156,  0.0053,  0.0077],
       grad_fn=&lt;SliceBackward&gt;)
8, &lt;class &#39;int&#39;&gt;
Transferring weights for class  State-gov, cat workclass from previous weights
old weight for class is tensor([ 0.0187, -0.0121,  0.0022, -0.0013,  0.0056, -0.0176],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0181, -0.0021,  0.0005,  0.0061, -0.0098,  0.0119],
       grad_fn=&lt;SliceBackward&gt;)
9, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Without-pay, cat workclass from previous weights
old weight for class is tensor([-0.0038,  0.0069,  0.0018, -0.0066, -0.0016, -0.0106],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0113, -0.0067, -0.0055,  0.0019,  0.0041,  0.0066],
       grad_fn=&lt;SliceBackward&gt;)
10, &lt;class &#39;int&#39;&gt;
Transferring weights for class Private, cat workclass using mean
old weight for class is tensor([-0.0024,  0.0142, -0.0060, -0.0050, -0.0119, -0.0003],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0027, -0.0050, -0.0009,  0.0026,  0.0011, -0.0004],
       grad_fn=&lt;SliceBackward&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

