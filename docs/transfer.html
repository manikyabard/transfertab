---

title: Core


keywords: fastai
sidebar: home_sidebar

summary: "Conatains methods for transferring."
description: "Conatains methods for transferring."
nb_path: "nbs/01_transfer.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_transfer.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">ADULT_SAMPLE</span><span class="p">)</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;adult.csv&#39;</span><span class="p">)</span>
<span class="n">splits1</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">valid_pct</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">range_of</span><span class="p">(</span><span class="n">df1</span><span class="p">))</span>
<span class="n">to1</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span><span class="n">Normalize</span><span class="p">],</span>
                   <span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">],</span>
                   <span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">],</span>
                   <span class="n">y_names</span><span class="o">=</span><span class="s1">&#39;salary&#39;</span><span class="p">,</span>
                   <span class="n">splits</span><span class="o">=</span><span class="n">splits1</span><span class="p">)</span>
<span class="n">dls1</span> <span class="o">=</span> <span class="n">to1</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">learn1</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls1</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>ModuleList(
  (0): Embedding(10, 6)
  (1): Embedding(17, 8)
  (2): Embedding(8, 5)
  (3): Embedding(16, 8)
  (4): Embedding(7, 5)
  (5): Embedding(6, 4)
  (6): Embedding(3, 3)
  (7): Embedding(3, 3)
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Aim is to take these embeddings and transfer them to other models</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">learn1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Parameter containing:
 tensor([[-5.6853e-03,  1.8688e-03,  1.4476e-02,  9.7890e-03,  1.4115e-02,
           5.7125e-03],
         [-9.1271e-03, -1.5946e-03,  5.6058e-03,  3.0356e-03,  2.5559e-03,
          -1.2680e-02],
         [-2.1623e-03, -4.1510e-05, -1.0180e-02,  1.3648e-02,  1.5476e-02,
          -1.8098e-03],
         [ 5.6572e-03,  1.5083e-02,  7.9600e-03, -7.3476e-04, -1.1631e-02,
          -7.4402e-03],
         [ 3.3497e-03, -3.0329e-03,  2.3689e-03, -3.3820e-03,  1.5509e-02,
          -9.7973e-03],
         [ 1.2162e-02,  1.0208e-02,  1.4835e-03,  8.3532e-03,  1.1189e-02,
           9.2965e-04],
         [ 8.5163e-03, -1.2888e-02,  8.2518e-03,  3.5525e-03,  4.3668e-03,
           3.4388e-03],
         [ 6.6009e-03, -5.5191e-03,  7.2820e-03,  1.3600e-02, -2.4659e-03,
          -6.2848e-04],
         [ 1.0715e-03, -3.1847e-03, -6.2840e-03, -6.0915e-03,  7.6644e-04,
           4.6805e-03],
         [ 1.5399e-02, -8.3873e-03, -8.9908e-03,  3.5097e-04, -7.0670e-03,
           1.1123e-02]], requires_grad=True),
 torch.Size([10, 6]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.371636</td>
      <td>0.351842</td>
      <td>0.838298</td>
      <td>00:04</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_rows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">49</span><span class="p">,</span><span class="s1">&#39;Private&#39;</span><span class="p">,</span><span class="mi">101320</span><span class="p">,</span><span class="s1">&#39;Assoc-acdm&#39;</span><span class="p">,</span><span class="mf">12.0</span><span class="p">,</span><span class="s1">&#39;Married-civ-spouse&#39;</span><span class="p">,</span><span class="s1">&#39;Exec-managerial&#39;</span><span class="p">,</span><span class="s1">&#39;Wife&#39;</span><span class="p">,</span><span class="s1">&#39;Robot&#39;</span><span class="p">,</span><span class="s1">&#39;Female&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1902</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="s1">&#39;United-States&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=50k&#39;</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">18</span><span class="p">,</span><span class="s1">&#39;Private&#39;</span><span class="p">,</span><span class="mi">182308</span><span class="p">,</span><span class="s1">&#39;Bachelors&#39;</span><span class="p">,</span><span class="mf">10.0</span><span class="p">,</span><span class="s1">&#39;Never-married&#39;</span><span class="p">,</span><span class="s1">&#39;?&#39;</span><span class="p">,</span><span class="s1">&#39;Own-child&#39;</span><span class="p">,</span><span class="s1">&#39;Other&#39;</span><span class="p">,</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="s1">&#39;United-States&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;50k&#39;</span><span class="p">]],</span>
                        <span class="n">columns</span><span class="o">=</span><span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32558</th>
      <td>53</td>
      <td>Private</td>
      <td>157069</td>
      <td>Assoc-acdm</td>
      <td>12.0</td>
      <td>Married-civ-spouse</td>
      <td>Machine-op-inspct</td>
      <td>Husband</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>32559</th>
      <td>32</td>
      <td>Local-gov</td>
      <td>217296</td>
      <td>HS-grad</td>
      <td>9.0</td>
      <td>Married-civ-spouse</td>
      <td>Transport-moving</td>
      <td>Wife</td>
      <td>White</td>
      <td>Female</td>
      <td>4064</td>
      <td>0</td>
      <td>22</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>32560</th>
      <td>26</td>
      <td>Private</td>
      <td>182308</td>
      <td>Some-college</td>
      <td>10.0</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Husband</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>32561</th>
      <td>49</td>
      <td>Private</td>
      <td>101320</td>
      <td>Assoc-acdm</td>
      <td>12.0</td>
      <td>Married-civ-spouse</td>
      <td>Exec-managerial</td>
      <td>Wife</td>
      <td>Robot</td>
      <td>Female</td>
      <td>0</td>
      <td>1902</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>32562</th>
      <td>18</td>
      <td>Private</td>
      <td>182308</td>
      <td>Bachelors</td>
      <td>10.0</td>
      <td>Never-married</td>
      <td>?</td>
      <td>Own-child</td>
      <td>Other</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>23</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits2</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">valid_pct</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">range_of</span><span class="p">(</span><span class="n">df2</span><span class="p">))</span>
<span class="n">to2</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span><span class="n">Normalize</span><span class="p">],</span>
                   <span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">],</span>
                   <span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">],</span>
                   <span class="n">y_names</span><span class="o">=</span><span class="s1">&#39;salary&#39;</span><span class="p">,</span>
                   <span class="n">splits</span><span class="o">=</span><span class="n">splits2</span><span class="p">)</span>
<span class="n">dls2</span> <span class="o">=</span> <span class="n">to2</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">learn2</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls2</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>ModuleList(
  (0): Embedding(11, 6)
  (1): Embedding(19, 8)
  (2): Embedding(10, 6)
  (3): Embedding(18, 8)
  (4): Embedding(9, 5)
  (5): Embedding(8, 5)
  (6): Embedding(5, 4)
  (7): Embedding(3, 3)
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TabTransfer" class="doc_header"><code>class</code> <code>TabTransfer</code><a href="https://github.com/manikyabard/transfertab/tree/master/transfertab/core.py#L6" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TabTransfer</code>(<strong><code>new_learner</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tabobj</span> <span class="o">=</span> <span class="n">TabTransfer</span><span class="p">(</span><span class="n">learn2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tabobj</span><span class="o">.</span><span class="n">init_from_json</span><span class="p">(</span><span class="s2">&quot;../data/adults.json&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mapping_dict</span> <span class="o">=</span> <span class="n">tabobj</span><span class="o">.</span><span class="n">mapping</span><span class="p">([</span><span class="s2">&quot;race&quot;</span><span class="p">,</span> <span class="s2">&quot;workclass&quot;</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;workclass&#39;, &#39;education&#39;, &#39;marital-status&#39;, &#39;occupation&#39;, &#39;relationship&#39;, &#39;race&#39;, &#39;sex&#39;, &#39;education-num_na&#39;]
What do you want to map gender to : sex
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tabobj</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">mapping_dict</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Encountered an error for variable race: Make sure embeddings dimensions are same for [[0.01424520742148161, 0.0019113835878670216, -0.011762626469135284, -0.011998647823929787], [0.03481021150946617, -0.03585974872112274, -0.003132576122879982, -0.014373430982232094], [-0.00021668781118933111, -0.02973216213285923, -0.01742439530789852, -0.00618526479229331], [0.05276366323232651, -0.0017447100253775716, -0.008110049180686474, -0.021954387426376343], [0.04621289297938347, -0.05134597048163414, -0.06927426904439926, -0.03336308151483536], [-0.016955429688096046, 0.020483478903770447, 0.028547359630465508, -0.010007286444306374]] with size 6, and Embedding(8, 5) with size 5
Moving on to other cat vars
mean is tensor([ 0.0036,  0.0035, -0.0027,  0.0065,  0.0021, -0.0059]) for tensor([[-0.0057,  0.0019,  0.0144,  0.0097,  0.0141,  0.0057],
        [-0.0317,  0.0007,  0.0077,  0.0139, -0.0221, -0.0226],
        [ 0.0533, -0.0063,  0.0469, -0.0314,  0.0574,  0.0322],
        [ 0.0165,  0.0365, -0.0122,  0.0023, -0.0144, -0.0079],
        [-0.0120,  0.0204,  0.0026, -0.0055,  0.0236, -0.0362],
        [-0.0086,  0.0461,  0.0067, -0.0026,  0.0232, -0.0509],
        [ 0.0619, -0.0427,  0.0406, -0.0403,  0.0576,  0.0453],
        [ 0.0216, -0.0126, -0.0440,  0.0787, -0.0520,  0.0040],
        [-0.0349, -0.0240, -0.0491,  0.0039, -0.0234, -0.0003],
        [-0.0242,  0.0150, -0.0408,  0.0364, -0.0426, -0.0285]])
0, &lt;class &#39;int&#39;&gt;
Transferring weights for class #na#, cat workclass using mean
old weight for class is tensor([ 0.0036,  0.0035, -0.0027,  0.0065,  0.0021, -0.0059],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0036,  0.0035, -0.0027,  0.0065,  0.0021, -0.0059],
       grad_fn=&lt;SliceBackward&gt;)
1, &lt;class &#39;int&#39;&gt;
Transferring weights for class  ?, cat workclass from previous weights
old weight for class is tensor([ 0.0216, -0.0126, -0.0440,  0.0787, -0.0520,  0.0040],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0216, -0.0126, -0.0440,  0.0787, -0.0520,  0.0040],
       grad_fn=&lt;SliceBackward&gt;)
2, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Federal-gov, cat workclass from previous weights
old weight for class is tensor([-0.0086,  0.0461,  0.0067, -0.0026,  0.0232, -0.0509],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0086,  0.0461,  0.0067, -0.0026,  0.0232, -0.0509],
       grad_fn=&lt;SliceBackward&gt;)
3, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Local-gov, cat workclass from previous weights
old weight for class is tensor([ 0.0619, -0.0427,  0.0406, -0.0403,  0.0576,  0.0453],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0619, -0.0427,  0.0406, -0.0403,  0.0576,  0.0453],
       grad_fn=&lt;SliceBackward&gt;)
4, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Never-worked, cat workclass from previous weights
old weight for class is tensor([-0.0242,  0.0150, -0.0408,  0.0364, -0.0426, -0.0285],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0242,  0.0150, -0.0408,  0.0364, -0.0426, -0.0285],
       grad_fn=&lt;SliceBackward&gt;)
5, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Private, cat workclass from previous weights
old weight for class is tensor([-0.0317,  0.0007,  0.0077,  0.0139, -0.0221, -0.0226],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0317,  0.0007,  0.0077,  0.0139, -0.0221, -0.0226],
       grad_fn=&lt;SliceBackward&gt;)
6, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Self-emp-inc, cat workclass from previous weights
old weight for class is tensor([ 0.0533, -0.0063,  0.0469, -0.0314,  0.0574,  0.0322],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0533, -0.0063,  0.0469, -0.0314,  0.0574,  0.0322],
       grad_fn=&lt;SliceBackward&gt;)
7, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Self-emp-not-inc, cat workclass from previous weights
old weight for class is tensor([ 0.0165,  0.0365, -0.0122,  0.0023, -0.0144, -0.0079],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0165,  0.0365, -0.0122,  0.0023, -0.0144, -0.0079],
       grad_fn=&lt;SliceBackward&gt;)
8, &lt;class &#39;int&#39;&gt;
Transferring weights for class  State-gov, cat workclass from previous weights
old weight for class is tensor([-0.0120,  0.0204,  0.0026, -0.0055,  0.0236, -0.0362],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0120,  0.0204,  0.0026, -0.0055,  0.0236, -0.0362],
       grad_fn=&lt;SliceBackward&gt;)
9, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Without-pay, cat workclass from previous weights
old weight for class is tensor([-0.0349, -0.0240, -0.0491,  0.0039, -0.0234, -0.0003],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0349, -0.0240, -0.0491,  0.0039, -0.0234, -0.0003],
       grad_fn=&lt;SliceBackward&gt;)
10, &lt;class &#39;int&#39;&gt;
Transferring weights for class Private, cat workclass using mean
old weight for class is tensor([ 0.0036,  0.0035, -0.0027,  0.0065,  0.0021, -0.0059],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0036,  0.0035, -0.0027,  0.0065,  0.0021, -0.0059],
       grad_fn=&lt;SliceBackward&gt;)
Encountered an error for variable sex: Make sure embeddings dimensions are same for [[-0.0017159931594505906, -0.0015294364420697093, 0.007879503071308136], [0.08940519392490387, -0.03518747165799141, -0.045552417635917664], [-0.03289536386728287, 0.02211097814142704, 0.021482935175299644]] with size 3, and Embedding(5, 4) with size 4
Moving on to other cat vars
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

