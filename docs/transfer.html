---

title: Core

keywords: fastai
sidebar: home_sidebar

summary: "Conatains methods for transferring."
description: "Conatains methods for transferring."
nb_path: "nbs/01_transfer.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_transfer.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">ADULT_SAMPLE</span><span class="p">)</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;adult.csv&#39;</span><span class="p">)</span>
<span class="n">splits1</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">valid_pct</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">range_of</span><span class="p">(</span><span class="n">df1</span><span class="p">))</span>
<span class="n">to1</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span><span class="n">Normalize</span><span class="p">],</span>
                   <span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">],</span>
                   <span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">],</span>
                   <span class="n">y_names</span><span class="o">=</span><span class="s1">&#39;salary&#39;</span><span class="p">,</span>
                   <span class="n">splits</span><span class="o">=</span><span class="n">splits1</span><span class="p">)</span>
<span class="n">dls1</span> <span class="o">=</span> <span class="n">to1</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">learn1</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls1</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>ModuleList(
  (0): Embedding(10, 6)
  (1): Embedding(17, 8)
  (2): Embedding(8, 5)
  (3): Embedding(16, 8)
  (4): Embedding(7, 5)
  (5): Embedding(6, 4)
  (6): Embedding(3, 3)
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Aim is to take these embeddings and transfer them to other models</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">learn1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Parameter containing:
 tensor([[-9.4948e-03, -8.0228e-03, -1.0030e-03,  4.9856e-03,  5.4568e-03,
           1.7855e-03],
         [-1.6155e-02, -1.9413e-03, -3.9701e-03, -1.2165e-02, -1.2602e-03,
          -8.0813e-03],
         [ 3.5964e-03,  5.6924e-03,  3.4328e-04, -1.1778e-02, -7.4721e-03,
           1.5772e-03],
         [-1.0661e-02, -2.9555e-03, -3.1351e-03,  2.2408e-03,  1.4735e-02,
          -3.2288e-03],
         [ 3.5296e-03, -6.1447e-03,  1.0373e-03, -1.9636e-02,  1.2360e-02,
           1.4212e-02],
         [-1.0681e-02,  1.3563e-03, -1.7049e-02,  2.7756e-03, -5.3467e-03,
           3.4818e-04],
         [ 6.8925e-03, -8.6594e-03,  1.2888e-03,  5.7663e-03,  9.4138e-04,
           2.8628e-03],
         [-1.1746e-02, -1.2486e-02, -1.1488e-04, -6.7977e-04, -8.0588e-03,
          -1.2513e-02],
         [ 5.6534e-05,  2.1546e-04, -7.2593e-03,  2.8732e-03, -1.3235e-03,
           7.4169e-03],
         [ 2.8654e-03,  3.2996e-03, -1.4163e-03,  3.0365e-03,  3.4331e-03,
          -1.6631e-02]], requires_grad=True),
 torch.Size([10, 6]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_rows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">49</span><span class="p">,</span><span class="s1">&#39;Private&#39;</span><span class="p">,</span><span class="mi">101320</span><span class="p">,</span><span class="s1">&#39;Assoc-acdm&#39;</span><span class="p">,</span><span class="mf">12.0</span><span class="p">,</span><span class="s1">&#39;Married-civ-spouse&#39;</span><span class="p">,</span><span class="s1">&#39;Exec-managerial&#39;</span><span class="p">,</span><span class="s1">&#39;Wife&#39;</span><span class="p">,</span><span class="s1">&#39;Robot&#39;</span><span class="p">,</span><span class="s1">&#39;Female&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1902</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="s1">&#39;United-States&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=50k&#39;</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">18</span><span class="p">,</span><span class="s1">&#39;Private&#39;</span><span class="p">,</span><span class="mi">182308</span><span class="p">,</span><span class="s1">&#39;Bachelors&#39;</span><span class="p">,</span><span class="mf">10.0</span><span class="p">,</span><span class="s1">&#39;Never-married&#39;</span><span class="p">,</span><span class="s1">&#39;?&#39;</span><span class="p">,</span><span class="s1">&#39;Own-child&#39;</span><span class="p">,</span><span class="s1">&#39;Other&#39;</span><span class="p">,</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="s1">&#39;United-States&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;50k&#39;</span><span class="p">]],</span>
                        <span class="n">columns</span><span class="o">=</span><span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32558</th>
      <td>53</td>
      <td>Private</td>
      <td>157069</td>
      <td>Assoc-acdm</td>
      <td>12.0</td>
      <td>Married-civ-spouse</td>
      <td>Machine-op-inspct</td>
      <td>Husband</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>32559</th>
      <td>32</td>
      <td>Local-gov</td>
      <td>217296</td>
      <td>HS-grad</td>
      <td>9.0</td>
      <td>Married-civ-spouse</td>
      <td>Transport-moving</td>
      <td>Wife</td>
      <td>White</td>
      <td>Female</td>
      <td>4064</td>
      <td>0</td>
      <td>22</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>32560</th>
      <td>26</td>
      <td>Private</td>
      <td>182308</td>
      <td>Some-college</td>
      <td>10.0</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Husband</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>32561</th>
      <td>49</td>
      <td>Private</td>
      <td>101320</td>
      <td>Assoc-acdm</td>
      <td>12.0</td>
      <td>Married-civ-spouse</td>
      <td>Exec-managerial</td>
      <td>Wife</td>
      <td>Robot</td>
      <td>Female</td>
      <td>0</td>
      <td>1902</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>32562</th>
      <td>18</td>
      <td>Private</td>
      <td>182308</td>
      <td>Bachelors</td>
      <td>10.0</td>
      <td>Never-married</td>
      <td>?</td>
      <td>Own-child</td>
      <td>Other</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>23</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits2</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">valid_pct</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">range_of</span><span class="p">(</span><span class="n">df2</span><span class="p">))</span>
<span class="n">to2</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span><span class="n">Normalize</span><span class="p">],</span>
                   <span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">],</span>
                   <span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">],</span>
                   <span class="n">y_names</span><span class="o">=</span><span class="s1">&#39;salary&#39;</span><span class="p">,</span>
                   <span class="n">splits</span><span class="o">=</span><span class="n">splits2</span><span class="p">)</span>
<span class="n">dls2</span> <span class="o">=</span> <span class="n">to2</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">learn2</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls2</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>ModuleList(
  (0): Embedding(11, 6)
  (1): Embedding(19, 8)
  (2): Embedding(10, 6)
  (3): Embedding(18, 8)
  (4): Embedding(9, 5)
  (5): Embedding(8, 5)
  (6): Embedding(3, 3)
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">cat_names</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#7) [&#39;workclass&#39;,&#39;education&#39;,&#39;marital-status&#39;,&#39;occupation&#39;,&#39;relationship&#39;,&#39;race&#39;,&#39;education-num_na&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">classes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;workclass&#39;: [&#39;#na#&#39;, &#39; ?&#39;, &#39; Federal-gov&#39;, &#39; Local-gov&#39;, &#39; Never-worked&#39;, &#39; Private&#39;, &#39; Self-emp-inc&#39;, &#39; Self-emp-not-inc&#39;, &#39; State-gov&#39;, &#39; Without-pay&#39;],
 &#39;education&#39;: [&#39;#na#&#39;, &#39; 10th&#39;, &#39; 11th&#39;, &#39; 12th&#39;, &#39; 1st-4th&#39;, &#39; 5th-6th&#39;, &#39; 7th-8th&#39;, &#39; 9th&#39;, &#39; Assoc-acdm&#39;, &#39; Assoc-voc&#39;, &#39; Bachelors&#39;, &#39; Doctorate&#39;, &#39; HS-grad&#39;, &#39; Masters&#39;, &#39; Preschool&#39;, &#39; Prof-school&#39;, &#39; Some-college&#39;],
 &#39;marital-status&#39;: [&#39;#na#&#39;, &#39; Divorced&#39;, &#39; Married-AF-spouse&#39;, &#39; Married-civ-spouse&#39;, &#39; Married-spouse-absent&#39;, &#39; Never-married&#39;, &#39; Separated&#39;, &#39; Widowed&#39;],
 &#39;occupation&#39;: [&#39;#na#&#39;, &#39; ?&#39;, &#39; Adm-clerical&#39;, &#39; Armed-Forces&#39;, &#39; Craft-repair&#39;, &#39; Exec-managerial&#39;, &#39; Farming-fishing&#39;, &#39; Handlers-cleaners&#39;, &#39; Machine-op-inspct&#39;, &#39; Other-service&#39;, &#39; Priv-house-serv&#39;, &#39; Prof-specialty&#39;, &#39; Protective-serv&#39;, &#39; Sales&#39;, &#39; Tech-support&#39;, &#39; Transport-moving&#39;],
 &#39;relationship&#39;: [&#39;#na#&#39;, &#39; Husband&#39;, &#39; Not-in-family&#39;, &#39; Other-relative&#39;, &#39; Own-child&#39;, &#39; Unmarried&#39;, &#39; Wife&#39;],
 &#39;race&#39;: [&#39;#na#&#39;, &#39; Amer-Indian-Eskimo&#39;, &#39; Asian-Pac-Islander&#39;, &#39; Black&#39;, &#39; Other&#39;, &#39; White&#39;],
 &#39;education-num_na&#39;: [&#39;#na#&#39;, False, True]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch     train_loss  valid_loss  accuracy  time    
0         0.375889    0.347853    0.838759  00:04     
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TabTransfer" class="doc_header"><code>class</code> <code>TabTransfer</code><a href="https://github.com/manikyabard/transfertab/tree/master/transfertab/core.py#L6" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TabTransfer</code>(<strong><code>old_learner</code></strong>, <strong><code>new_learner</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">embedding_dim</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>6</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tabobj</span> <span class="o">=</span> <span class="n">TabTransfer</span><span class="p">(</span><span class="n">learn1</span><span class="p">,</span> <span class="n">learn2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tabobj</span><span class="o">.</span><span class="n">transfer</span><span class="p">([</span><span class="s2">&quot;race&quot;</span><span class="p">,</span> <span class="s2">&quot;workclass&quot;</span><span class="p">],</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Encountered an error for variable race: Make sure embeddings dimensions are same for Embedding(6, 4) and Embedding(8, 5)
Moving on to other cat vars
mean is tensor([-0.0117,  0.0015, -0.0070, -0.0041, -0.0016, -0.0030],
       grad_fn=&lt;MeanBackward1&gt;) for Parameter containing:
tensor([[-0.0095, -0.0080, -0.0010,  0.0050,  0.0054,  0.0018],
        [-0.0257,  0.0145, -0.0246, -0.0116, -0.0239, -0.0175],
        [ 0.0356, -0.0378,  0.0255,  0.0302,  0.0010,  0.0535],
        [-0.0335, -0.0008, -0.0040, -0.0088,  0.0437, -0.0234],
        [-0.0035,  0.0144, -0.0053, -0.0161,  0.0081,  0.0213],
        [ 0.0246, -0.0193, -0.0273,  0.0203, -0.0426,  0.0175],
        [ 0.0327, -0.0590,  0.0567,  0.0367,  0.0288,  0.0402],
        [-0.0485,  0.0436, -0.0329, -0.0606, -0.0063, -0.0495],
        [-0.0470,  0.0217, -0.0159,  0.0074,  0.0009, -0.0349],
        [-0.0424,  0.0456, -0.0409, -0.0431, -0.0314, -0.0390]],
       requires_grad=True)
0, &lt;class &#39;int&#39;&gt;
Transferring weights for class #na#, cat workclass from previous weights
old weight for class is tensor([-0.0095, -0.0080, -0.0010,  0.0050,  0.0054,  0.0018],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0095, -0.0080, -0.0010,  0.0050,  0.0054,  0.0018],
       grad_fn=&lt;SliceBackward&gt;)
1, &lt;class &#39;int&#39;&gt;
Transferring weights for class  ?, cat workclass from previous weights
old weight for class is tensor([-0.0257,  0.0145, -0.0246, -0.0116, -0.0239, -0.0175],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0257,  0.0145, -0.0246, -0.0116, -0.0239, -0.0175],
       grad_fn=&lt;SliceBackward&gt;)
2, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Federal-gov, cat workclass from previous weights
old weight for class is tensor([ 0.0356, -0.0378,  0.0255,  0.0302,  0.0010,  0.0535],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0356, -0.0378,  0.0255,  0.0302,  0.0010,  0.0535],
       grad_fn=&lt;SliceBackward&gt;)
3, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Local-gov, cat workclass from previous weights
old weight for class is tensor([-0.0335, -0.0008, -0.0040, -0.0088,  0.0437, -0.0234],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0335, -0.0008, -0.0040, -0.0088,  0.0437, -0.0234],
       grad_fn=&lt;SliceBackward&gt;)
4, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Never-worked, cat workclass from previous weights
old weight for class is tensor([-0.0035,  0.0144, -0.0053, -0.0161,  0.0081,  0.0213],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0035,  0.0144, -0.0053, -0.0161,  0.0081,  0.0213],
       grad_fn=&lt;SliceBackward&gt;)
5, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Private, cat workclass from previous weights
old weight for class is tensor([ 0.0246, -0.0193, -0.0273,  0.0203, -0.0426,  0.0175],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0246, -0.0193, -0.0273,  0.0203, -0.0426,  0.0175],
       grad_fn=&lt;SliceBackward&gt;)
6, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Self-emp-inc, cat workclass from previous weights
old weight for class is tensor([ 0.0327, -0.0590,  0.0567,  0.0367,  0.0288,  0.0402],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0327, -0.0590,  0.0567,  0.0367,  0.0288,  0.0402],
       grad_fn=&lt;SliceBackward&gt;)
7, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Self-emp-not-inc, cat workclass from previous weights
old weight for class is tensor([-0.0485,  0.0436, -0.0329, -0.0606, -0.0063, -0.0495],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0485,  0.0436, -0.0329, -0.0606, -0.0063, -0.0495],
       grad_fn=&lt;SliceBackward&gt;)
8, &lt;class &#39;int&#39;&gt;
Transferring weights for class  State-gov, cat workclass from previous weights
old weight for class is tensor([-0.0470,  0.0217, -0.0159,  0.0074,  0.0009, -0.0349],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0470,  0.0217, -0.0159,  0.0074,  0.0009, -0.0349],
       grad_fn=&lt;SliceBackward&gt;)
9, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Without-pay, cat workclass from previous weights
old weight for class is tensor([-0.0424,  0.0456, -0.0409, -0.0431, -0.0314, -0.0390],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0424,  0.0456, -0.0409, -0.0431, -0.0314, -0.0390],
       grad_fn=&lt;SliceBackward&gt;)
10, &lt;class &#39;int&#39;&gt;
Transferring weights for class Private, cat workclass using mean
old weight for class is tensor([-0.0117,  0.0015, -0.0070, -0.0041, -0.0016, -0.0030],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0117,  0.0015, -0.0070, -0.0041, -0.0016, -0.0030],
       grad_fn=&lt;SliceBackward&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

