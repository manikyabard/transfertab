---

title: Core

keywords: fastai
sidebar: home_sidebar

summary: "Conatains methods for transferring."
description: "Conatains methods for transferring."
nb_path: "nbs/01_transfer.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_transfer.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">ADULT_SAMPLE</span><span class="p">)</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;adult.csv&#39;</span><span class="p">)</span>
<span class="n">splits1</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">valid_pct</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">range_of</span><span class="p">(</span><span class="n">df1</span><span class="p">))</span>
<span class="n">to1</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span><span class="n">Normalize</span><span class="p">],</span>
                   <span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">],</span>
                   <span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">],</span>
                   <span class="n">y_names</span><span class="o">=</span><span class="s1">&#39;salary&#39;</span><span class="p">,</span>
                   <span class="n">splits</span><span class="o">=</span><span class="n">splits1</span><span class="p">)</span>
<span class="n">dls1</span> <span class="o">=</span> <span class="n">to1</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">learn1</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls1</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>ModuleList(
  (0): Embedding(10, 6)
  (1): Embedding(17, 8)
  (2): Embedding(8, 5)
  (3): Embedding(16, 8)
  (4): Embedding(7, 5)
  (5): Embedding(6, 4)
  (6): Embedding(3, 3)
  (7): Embedding(3, 3)
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Aim is to take these embeddings and transfer them to other models</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">learn1</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Parameter containing:
 tensor([[-1.5184e-03, -7.1496e-03, -9.6997e-03, -7.1375e-03, -1.8106e-02,
          -3.0497e-03],
         [ 1.4365e-02, -5.4501e-03, -4.0899e-03,  1.6883e-03, -9.0649e-03,
           1.7529e-04],
         [-7.8978e-03,  9.8942e-03, -8.7569e-03, -2.1801e-03,  5.3743e-03,
           5.0876e-03],
         [ 1.4316e-03,  9.9742e-03,  1.2166e-02, -6.7172e-04,  6.5607e-03,
          -9.9967e-03],
         [-1.4267e-02, -6.8543e-03,  4.4413e-03,  1.0773e-02,  3.8300e-03,
           3.7381e-03],
         [ 3.6100e-03, -1.0196e-03, -1.1467e-02, -1.2446e-02,  1.9815e-04,
           5.9060e-03],
         [-5.1308e-05, -9.9837e-03, -1.0518e-02, -8.9132e-03,  2.4865e-03,
          -2.9645e-03],
         [ 7.5990e-04, -3.0851e-03, -2.9387e-03, -4.9918e-03, -1.4173e-02,
          -1.8315e-03],
         [-1.5551e-03,  9.7467e-03,  5.9534e-03,  1.1147e-02, -1.1841e-02,
          -8.1780e-04],
         [-1.2227e-03,  1.4325e-02, -2.0262e-03, -1.0725e-02, -3.6891e-03,
          -2.7537e-03]], requires_grad=True),
 torch.Size([10, 6]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.373020</td>
      <td>0.346422</td>
      <td>0.837838</td>
      <td>00:04</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_rows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">49</span><span class="p">,</span><span class="s1">&#39;Private&#39;</span><span class="p">,</span><span class="mi">101320</span><span class="p">,</span><span class="s1">&#39;Assoc-acdm&#39;</span><span class="p">,</span><span class="mf">12.0</span><span class="p">,</span><span class="s1">&#39;Married-civ-spouse&#39;</span><span class="p">,</span><span class="s1">&#39;Exec-managerial&#39;</span><span class="p">,</span><span class="s1">&#39;Wife&#39;</span><span class="p">,</span><span class="s1">&#39;Robot&#39;</span><span class="p">,</span><span class="s1">&#39;Female&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1902</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="s1">&#39;United-States&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;=50k&#39;</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">18</span><span class="p">,</span><span class="s1">&#39;Private&#39;</span><span class="p">,</span><span class="mi">182308</span><span class="p">,</span><span class="s1">&#39;Bachelors&#39;</span><span class="p">,</span><span class="mf">10.0</span><span class="p">,</span><span class="s1">&#39;Never-married&#39;</span><span class="p">,</span><span class="s1">&#39;?&#39;</span><span class="p">,</span><span class="s1">&#39;Own-child&#39;</span><span class="p">,</span><span class="s1">&#39;Other&#39;</span><span class="p">,</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="s1">&#39;United-States&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;50k&#39;</span><span class="p">]],</span>
                        <span class="n">columns</span><span class="o">=</span><span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32558</th>
      <td>53</td>
      <td>Private</td>
      <td>157069</td>
      <td>Assoc-acdm</td>
      <td>12.0</td>
      <td>Married-civ-spouse</td>
      <td>Machine-op-inspct</td>
      <td>Husband</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>32559</th>
      <td>32</td>
      <td>Local-gov</td>
      <td>217296</td>
      <td>HS-grad</td>
      <td>9.0</td>
      <td>Married-civ-spouse</td>
      <td>Transport-moving</td>
      <td>Wife</td>
      <td>White</td>
      <td>Female</td>
      <td>4064</td>
      <td>0</td>
      <td>22</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>32560</th>
      <td>26</td>
      <td>Private</td>
      <td>182308</td>
      <td>Some-college</td>
      <td>10.0</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Husband</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>32561</th>
      <td>49</td>
      <td>Private</td>
      <td>101320</td>
      <td>Assoc-acdm</td>
      <td>12.0</td>
      <td>Married-civ-spouse</td>
      <td>Exec-managerial</td>
      <td>Wife</td>
      <td>Robot</td>
      <td>Female</td>
      <td>0</td>
      <td>1902</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>32562</th>
      <td>18</td>
      <td>Private</td>
      <td>182308</td>
      <td>Bachelors</td>
      <td>10.0</td>
      <td>Never-married</td>
      <td>?</td>
      <td>Own-child</td>
      <td>Other</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>23</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits2</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">valid_pct</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">range_of</span><span class="p">(</span><span class="n">df2</span><span class="p">))</span>
<span class="n">to2</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span><span class="n">Normalize</span><span class="p">],</span>
                   <span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">],</span>
                   <span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">],</span>
                   <span class="n">y_names</span><span class="o">=</span><span class="s1">&#39;salary&#39;</span><span class="p">,</span>
                   <span class="n">splits</span><span class="o">=</span><span class="n">splits2</span><span class="p">)</span>
<span class="n">dls2</span> <span class="o">=</span> <span class="n">to2</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">learn2</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls2</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn2</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">embeds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>ModuleList(
  (0): Embedding(11, 6)
  (1): Embedding(19, 8)
  (2): Embedding(10, 6)
  (3): Embedding(18, 8)
  (4): Embedding(9, 5)
  (5): Embedding(8, 5)
  (6): Embedding(5, 4)
  (7): Embedding(3, 3)
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TabTransfer" class="doc_header"><code>class</code> <code>TabTransfer</code><a href="https://github.com/manikyabard/transfertab/tree/master/transfertab/core.py#L6" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TabTransfer</code>(<strong><code>new_learner</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tabobj</span> <span class="o">=</span> <span class="n">TabTransfer</span><span class="p">(</span><span class="n">learn2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tabobj</span><span class="o">.</span><span class="n">init_from_json</span><span class="p">(</span><span class="s2">&quot;../data/adults.json&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tabobj</span><span class="o">.</span><span class="n">transfer</span><span class="p">([</span><span class="s2">&quot;race&quot;</span><span class="p">,</span> <span class="s2">&quot;workclass&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">],</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Encountered an error for variable race: Make sure embeddings dimensions are same for [[-0.003057310124859214, -0.01121451798826456, 0.0006751518812961876, -0.0022854332346469164], [0.05106708034873009, -0.040885455906391144, 0.05320250615477562, -0.012832402251660824], [-0.005895806010812521, -0.018627915531396866, 0.017118563875555992, -0.023926209658384323], [0.006974412128329277, -0.014671240001916885, 0.042595550417900085, 0.004545277450233698], [0.01667597144842148, -0.025080526247620583, 0.04978727549314499, -0.03059406764805317], [-0.011430840007960796, 0.021843088790774345, -0.05483167991042137, 0.009506236761808395]] with size 6, and Embedding(8, 5) with size 5
Moving on to other cat vars
mean is tensor([-4.3801e-04, -1.7851e-03, -8.0605e-05, -3.4863e-03, -8.5167e-03,
         7.4557e-04]) for tensor([[-1.5122e-03, -7.1206e-03, -9.6603e-03, -7.1085e-03, -1.8033e-02,
         -3.0373e-03],
        [-1.8883e-02, -4.9310e-02,  2.3438e-02, -1.1464e-02, -2.6982e-02,
         -1.5785e-03],
        [ 4.1349e-02,  2.1057e-02, -5.7505e-02, -3.3724e-02,  5.3201e-02,
          4.7953e-02],
        [ 1.3505e-02,  2.2205e-02,  1.7375e-02,  6.5449e-03, -6.8122e-03,
         -5.6957e-03],
        [ 3.7275e-03, -1.8505e-02, -1.6402e-03,  1.8197e-02, -1.0030e-03,
          7.8835e-03],
        [ 1.9420e-03,  8.6775e-05,  8.2344e-04,  3.4259e-02,  2.7123e-02,
         -1.6212e-02],
        [ 6.7098e-02,  2.1276e-02, -7.0232e-02, -3.6847e-02,  4.0436e-02,
          2.3149e-02],
        [-4.8378e-02, -1.2042e-02,  4.5346e-02, -9.2270e-03, -7.4573e-02,
          8.4785e-04],
        [-4.4342e-02, -1.9307e-02,  3.3685e-02, -4.8446e-03, -4.8069e-02,
         -3.5065e-02],
        [-1.8885e-02,  2.3808e-02,  1.7563e-02,  9.3505e-03, -3.0455e-02,
         -1.0788e-02]])
0, &lt;class &#39;int&#39;&gt;
Transferring weights for class #na#, cat workclass using mean
old weight for class is tensor([-0.0054,  0.0008, -0.0176,  0.0005, -0.0066, -0.0125],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-4.3801e-04, -1.7851e-03, -8.0605e-05, -3.4863e-03, -8.5167e-03,
         7.4557e-04], grad_fn=&lt;SliceBackward&gt;)
1, &lt;class &#39;int&#39;&gt;
Transferring weights for class  ?, cat workclass from previous weights
old weight for class is tensor([ 0.0075, -0.0081,  0.0047, -0.0198, -0.0091,  0.0044],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0484, -0.0120,  0.0453, -0.0092, -0.0746,  0.0008],
       grad_fn=&lt;SliceBackward&gt;)
2, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Federal-gov, cat workclass from previous weights
old weight for class is tensor([-0.0017, -0.0014,  0.0112, -0.0078, -0.0149, -0.0052],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 1.9420e-03,  8.6775e-05,  8.2344e-04,  3.4259e-02,  2.7123e-02,
        -1.6212e-02], grad_fn=&lt;SliceBackward&gt;)
3, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Local-gov, cat workclass from previous weights
old weight for class is tensor([-0.0148,  0.0037,  0.0083, -0.0035, -0.0091, -0.0079],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0671,  0.0213, -0.0702, -0.0368,  0.0404,  0.0231],
       grad_fn=&lt;SliceBackward&gt;)
4, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Never-worked, cat workclass from previous weights
old weight for class is tensor([ 0.0050, -0.0046,  0.0023, -0.0093,  0.0084,  0.0158],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0189,  0.0238,  0.0176,  0.0094, -0.0305, -0.0108],
       grad_fn=&lt;SliceBackward&gt;)
5, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Private, cat workclass from previous weights
old weight for class is tensor([-0.0031,  0.0120, -0.0081, -0.0059, -0.0037,  0.0026],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0189, -0.0493,  0.0234, -0.0115, -0.0270, -0.0016],
       grad_fn=&lt;SliceBackward&gt;)
6, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Self-emp-inc, cat workclass from previous weights
old weight for class is tensor([ 0.0140,  0.0064,  0.0172,  0.0007,  0.0032, -0.0023],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0413,  0.0211, -0.0575, -0.0337,  0.0532,  0.0480],
       grad_fn=&lt;SliceBackward&gt;)
7, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Self-emp-not-inc, cat workclass from previous weights
old weight for class is tensor([ 0.0101, -0.0178,  0.0003,  0.0093, -0.0126, -0.0081],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0135,  0.0222,  0.0174,  0.0065, -0.0068, -0.0057],
       grad_fn=&lt;SliceBackward&gt;)
8, &lt;class &#39;int&#39;&gt;
Transferring weights for class  State-gov, cat workclass from previous weights
old weight for class is tensor([ 0.0120,  0.0017,  0.0034,  0.0121,  0.0040, -0.0010],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([ 0.0037, -0.0185, -0.0016,  0.0182, -0.0010,  0.0079],
       grad_fn=&lt;SliceBackward&gt;)
9, &lt;class &#39;int&#39;&gt;
Transferring weights for class  Without-pay, cat workclass from previous weights
old weight for class is tensor([-0.0022, -0.0128, -0.0025, -0.0132, -0.0165, -0.0036],
       grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-0.0443, -0.0193,  0.0337, -0.0048, -0.0481, -0.0351],
       grad_fn=&lt;SliceBackward&gt;)
10, &lt;class &#39;int&#39;&gt;
Transferring weights for class Private, cat workclass using mean
old weight for class is tensor([ 4.3590e-03,  4.0752e-03,  1.2201e-02, -7.4143e-05, -1.2825e-03,
        -1.1770e-02], grad_fn=&lt;SliceBackward&gt;)
new weight for class is tensor([-4.3801e-04, -1.7851e-03, -8.0605e-05, -3.4863e-03, -8.5167e-03,
         7.4557e-04], grad_fn=&lt;SliceBackward&gt;)
Encountered an error for variable sex: Make sure embeddings dimensions are same for [[-0.008142838254570961, 0.0009687276906333864, -0.005184521898627281], [-0.06315058469772339, 0.04905426502227783, 0.029599010944366455], [0.06200817972421646, -0.036537621170282364, -0.032290488481521606]] with size 3, and Embedding(5, 4) with size 4
Moving on to other cat vars
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

